<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>æµ…è°ˆé¸¿è’™çŠ¶æ€ç®¡ç†V1â€”â€”&gt;V2 | XBXyftx</title><meta name="author" content="XBXyftx"><meta name="copyright" content="XBXyftx"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ç”¨å®é™…ä»£ç æµ‹è¯•ä¸æˆ‘çš„å¼€å‘ç»éªŒï¼Œè§£æé¸¿è’™çŠ¶æ€ç®¡ç†V2ä¸­éš¾ä»¥ç†è§£çš„å†…å®¹ï¼Œå¸®åŠ©å¼€å‘è€…ä»¬æ›´å¥½çš„ç†è§£å’Œä½¿ç”¨çŠ¶æ€ç®¡ç†V2ç‰ˆæœ¬ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="æµ…è°ˆé¸¿è’™çŠ¶æ€ç®¡ç†V1â€”â€”&gt;V2">
<meta property="og:url" content="https://xbxyftx.top/2025/02/04/V2/index.html">
<meta property="og:site_name" content="XBXyftx">
<meta property="og:description" content="ç”¨å®é™…ä»£ç æµ‹è¯•ä¸æˆ‘çš„å¼€å‘ç»éªŒï¼Œè§£æé¸¿è’™çŠ¶æ€ç®¡ç†V2ä¸­éš¾ä»¥ç†è§£çš„å†…å®¹ï¼Œå¸®åŠ©å¼€å‘è€…ä»¬æ›´å¥½çš„ç†è§£å’Œä½¿ç”¨çŠ¶æ€ç®¡ç†V2ç‰ˆæœ¬ã€‚">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xbxyftx.top/img/ArticleTopImgs/V2TopImg.png">
<meta property="article:published_time" content="2025-02-03T17:02:36.000Z">
<meta property="article:modified_time" content="2025-06-24T02:10:37.313Z">
<meta property="article:author" content="XBXyftx">
<meta property="article:tag" content="é¸¿è’™">
<meta property="article:tag" content="æŠ€æœ¯å‘">
<meta property="article:tag" content="V2">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xbxyftx.top/img/ArticleTopImgs/V2TopImg.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "æµ…è°ˆé¸¿è’™çŠ¶æ€ç®¡ç†V1â€”â€”>V2",
  "url": "https://xbxyftx.top/2025/02/04/V2/",
  "image": "https://xbxyftx.top/img/ArticleTopImgs/V2TopImg.png",
  "datePublished": "2025-02-03T17:02:36.000Z",
  "dateModified": "2025-06-24T02:10:37.313Z",
  "author": [
    {
      "@type": "Person",
      "name": "XBXyftx",
      "url": "https://github.com/XBXyftx"
    }
  ]
}</script><link rel="shortcut icon" href="/img/logo.png"><link rel="canonical" href="https://xbxyftx.top/2025/02/04/V2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css"><link rel="stylesheet" href="/css/typewriter-effect.css"><link rel="stylesheet" href="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶å¤±è´¥',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: {"limitCount":2000,"languages":{"author":"ä½œè€…: XBXyftx","link":"é“¾æ¥: ","source":"æ¥æº: XBXyftx","info":"è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚"}},
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"å·²åˆ‡æ¢ä¸ºç¹ä½“ä¸­æ–‡","cht_to_chs":"å·²åˆ‡æ¢ä¸ºç®€ä½“ä¸­æ–‡","day_to_night":"å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼","night_to_day":"å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: '/',
    buttonText: 'åŠ è½½æ›´å¤š'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'æµ…è°ˆé¸¿è’™çŠ¶æ€ç®¡ç†V1â€”â€”>V2',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post',
  typewriter: 'ğŸš€ æ·±åº¦è§£æé¸¿è’™çŠ¶æ€ç®¡ç†çš„è¿›åŒ–ä¹‹è·¯ï¼æœ¬æ–‡åŸºäºå®é™…å¼€å‘ç»éªŒï¼Œè¯¦ç»†å¯¹æ¯”äº†V1ä¸V2çŠ¶æ€ç®¡ç†çš„æ ¸å¿ƒå·®å¼‚ä¸æŠ€æœ¯ä¼˜åŠ¿ã€‚é€šè¿‡å…·ä½“ä»£ç ç¤ºä¾‹æ·±å…¥è®²è§£@Stateã€@Localã€@Paramã€@Onceç­‰è£…é¥°å™¨çš„ä½¿ç”¨åœºæ™¯ä¸æ³¨æ„äº‹é¡¹ã€‚é‡ç‚¹é˜è¿°äº†V2åœ¨ç»„ä»¶å°è£…æ€§ã€æ•°æ®ä¼ é€’å®‰å…¨æ€§ã€æ€§èƒ½ä¼˜åŒ–ç­‰æ–¹é¢çš„æ˜¾è‘—æ”¹è¿›ã€‚ç”¨é€šä¿—æ˜“æ‡‚çš„è¯­è¨€è§£é‡Šäº†å®˜æ–¹æ–‡æ¡£ä¸­çš„æ™¦æ¶©æ¦‚å¿µï¼Œä¸ºå¼€å‘è€…æä¾›äº†ä»V1å¹³æ»‘è¿ç§»åˆ°V2çš„å®ç”¨æŒ‡å—ã€‚'
}</script><script src="/js/nyan.js"></script><script>localStorage.setItem('theme','dark')</script><script>document.documentElement.setAttribute('data-theme', 'dark');</script><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="/css/transpancy.css"><script> // å¼ºåˆ¶é”å®šä¸ºæš—é»‘æ¨¡å¼ localStorage.setItem('theme', 'dark'); // é˜²æ­¢å…¶ä»–è„šæœ¬è¦†ç›–æ¨¡å¼ document.documentElement.setAttribute('data-theme', 'dark'); </script><link rel="stylesheet" href="/css/styles.css"><script> document.querySelectorAll('#post-comment').forEach(el => { el.style.backgroundColor = 'rgba(255, 255, 255, 0.6)'; }); </script><link rel="twikoo" href="/css/twikoo.css"><link rel="stylesheet" href="/css/rightmenu.css"><script src="/js/custom-lightbox.js" defer></script><script src="/js/nyan.js"></script><script src="/js/header-universe.js"></script><!-- æ–°å¢ç¼“å­˜ç®¡ç†è„šæœ¬ - å·²ç¦ç”¨Service Worker--><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="cat__scene"><div class="cat__main"><div class="cat__body"></div><div class="cat__body"></div><div class="cat__tail"></div><div class="cat__head"></div></div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
      setTimeout(() => {
        $loadingBox.style.display = 'none'
      }, 800)
    },
    initLoading: () => {
      $loadingBox.style.display = 'flex'
      $loadingBox.classList.remove('loaded')
      $body.style.overflow = 'hidden'
    }
  }

  preloader.initLoading()
  
  // è®¾ç½®10ç§’è¶…æ—¶
  const loadingTimeout = setTimeout(() => {
    preloader.endLoading()
  }, 10000)
  
  window.addEventListener('load', () => {
    clearTimeout(loadingTimeout)
    preloader.endLoading()
  })

  if (false) {
    btf.addGlobalFn('pjaxSend', preloader.initLoading, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', preloader.endLoading, 'preloader_end')
  }
})()</script><div id="web_bg" style="background-image: url(/img/bg1.png);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/logo.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">34</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa-solid fa-comment"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/swiper/"><i class="fa-fw fa-solid fa-star-of-david"></i><span> æ˜¨æ—¥é‡ç°</span></a></div><div class="menus_item"><a class="site-page" href="/LianlianKan/"><i class="fa-fw fa-solid fa-gamepad"></i><span> è¿è¿çœ‹</span></a></div><div class="menus_item"><a class="site-page" href="/MarkdownPreview/"><i class="fa-fw fa-solid fa-file-code"></i><span> MDåœ¨çº¿ç¼–è¾‘å™¨</span></a></div><div class="menus_item"><a class="site-page" href="/coffer/"><i class="fa-fw fa-solid fa-key"></i><span> ç§˜å¯†åŸºåœ°</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºæˆ‘</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/ArticleTopImgs/V2TopImg.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/logo.png" alt="Logo"><span class="site-name">XBXyftx</span></a><a class="nav-page-title" href="/"><span class="site-name">æµ…è°ˆé¸¿è’™çŠ¶æ€ç®¡ç†V1â€”â€”&gt;V2</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> å½’æ¡£</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹æƒ…é“¾æ¥</span></a></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw fa-solid fa-comment"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/swiper/"><i class="fa-fw fa-solid fa-star-of-david"></i><span> æ˜¨æ—¥é‡ç°</span></a></div><div class="menus_item"><a class="site-page" href="/LianlianKan/"><i class="fa-fw fa-solid fa-gamepad"></i><span> è¿è¿çœ‹</span></a></div><div class="menus_item"><a class="site-page" href="/MarkdownPreview/"><i class="fa-fw fa-solid fa-file-code"></i><span> MDåœ¨çº¿ç¼–è¾‘å™¨</span></a></div><div class="menus_item"><a class="site-page" href="/coffer/"><i class="fa-fw fa-solid fa-key"></i><span> ç§˜å¯†åŸºåœ°</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äºæˆ‘</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">æµ…è°ˆé¸¿è’™çŠ¶æ€ç®¡ç†V1â€”â€”&gt;V2</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2025-02-03T17:02:36.000Z" title="å‘è¡¨äº 2025-02-04 01:02:36">2025-02-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2025-06-24T02:10:37.313Z" title="æ›´æ–°äº 2025-06-24 10:10:37">2025-06-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">æ€»å­—æ•°:</span><span class="word-count">4.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>17åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">æµè§ˆé‡:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><div id="post-outdate-notice" data="{&quot;limitDay&quot;:100,&quot;messagePrev&quot;:&quot;It has been&quot;,&quot;messageNext&quot;:&quot;days since the last update, the content of the article may be outdated.&quot;,&quot;postUpdate&quot;:&quot;2025-06-24 10:10:37&quot;}" hidden></div><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨é¸¿è’™å¼€å‘ä¸­ï¼ŒçŠ¶æ€ç®¡ç†æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µã€‚å®ƒæ¶‰åŠåˆ°å¦‚ä½•åœ¨åº”ç”¨ç¨‹åºä¸­<strong>å­˜å‚¨å’Œç®¡ç†æ•°æ®</strong>ï¼Œä»¥ä¾¿åœ¨ä¸åŒçš„ç»„ä»¶ã€Abilityä¹‹é—´å…±äº«å’Œè®¿é—®ã€‚<br>çŠ¶æ€ç®¡ç†çš„ç›®æ ‡æ˜¯ç¡®ä¿åº”ç”¨ç¨‹åºçš„<strong>æ•°æ®ä¸€è‡´æ€§</strong>å’Œ<strong>å¯ç»´æŠ¤æ€§</strong>ã€‚å®ƒè¿˜å¯ä»¥å¸®åŠ©å¼€å‘è€…æ›´å¥½åœ°ç†è§£åº”ç”¨ç¨‹åºçš„<strong>æ•°æ®æµ</strong>å’Œ<strong>æ•°æ®ä¾èµ–å…³ç³»</strong>ï¼Œä»è€Œæ›´å¥½åœ°è®¾è®¡å’Œå®ç°åº”ç”¨ç¨‹åºã€‚</p>
<p>æˆªæ­¢åˆ°ç›®å‰ï¼Œé¸¿è’™å¼€å‘ä¸­çš„çŠ¶æ€ç®¡ç†åˆ†ä¸ºä¸¤ä¸ªç‰ˆæœ¬<strong>V1å’ŒV2</strong>ã€‚</p>
<p>V1ä½œä¸ºæœ€åˆçš„ä¸€ä»£çŠ¶æ€ç®¡ç†æ¡†æ¶ï¼Œå…¶åŠŸèƒ½å·²ç»æ»¡è¶³äº†ç»å¤§å¤šæ•°çš„åº”ç”¨å¼€å‘éœ€æ±‚ï¼Œä½†ä»æœ‰è®¸å¤šä¸è¶³ã€‚<br>V2ä½œä¸ºæ–°ä¸€ä»£çš„çŠ¶æ€ç®¡ç†æ¡†æ¶ï¼Œå…¶åŠŸèƒ½æ›´åŠ å®Œå–„ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°æ»¡è¶³åº”ç”¨å¼€å‘çš„éœ€æ±‚ã€‚</p>
<p><img src="/2025/02/04/V2/1.png" alt="1"></p>
<p>é’ˆå¯¹äºV1å’ŒV2çš„åŒºåˆ«ï¼Œå®˜æ–¹æ–‡æ¡£ç»™å‡ºäº†ååˆ†è¯¦å°½çš„è§£é‡Šã€‚æˆ‘ä¹Ÿä¸å†è¯¦ç»†çš„èµ˜è¿°ï¼Œç›´æ¥ç»™å‡ºå®˜æ–¹æ–‡æ¡£çš„é“¾æ¥ã€‚<br><a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ts-v1-v2-migration-V5">V1â€”â€”&gt;V2è¿ç§»æŒ‡å—</a><br><a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ts-v2-decorators-V5">V2è£…é¥°å™¨æŒ‡å—</a><br><a target="_blank" rel="noopener" href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides-V5/ts-new-other-state-mgmt-V5">V2å…¶ä»–çŠ¶æ€ç®¡ç†</a></p>
<p>æ¥ä¸‹æ¥æˆ‘ä¼šç”¨æˆ‘çš„å®é™…ç»éªŒæ¥è§£é‡Šä¸€äº›æ–‡æ¡£ä¸­å†™çš„æœ‰äº›æ™¦æ¶©çš„å†…å®¹ã€‚</p>
<h2 id="Stateå’Œ-Loaclã€-Param-Once"><a href="#Stateå’Œ-Loaclã€-Param-Once" class="headerlink" title="@Stateå’Œ@Loaclã€@Param@Once"></a><code>@State</code>å’Œ<code>@Loacl</code>ã€<code>@Param@Once</code></h2><h3 id="Stateçš„ç¼ºé™·ä¸V2çš„è§£å†³æ–¹æ¡ˆ"><a href="#Stateçš„ç¼ºé™·ä¸V2çš„è§£å†³æ–¹æ¡ˆ" class="headerlink" title="@Stateçš„ç¼ºé™·ä¸V2çš„è§£å†³æ–¹æ¡ˆ"></a><code>@State</code>çš„ç¼ºé™·ä¸V2çš„è§£å†³æ–¹æ¡ˆ</h3><p><code>@State</code>æ— ç–‘æ˜¯V1ä¸­æœ€ä¸ºå¸¸ç”¨çš„è£…é¥°å™¨ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªå˜é‡å£°æ˜ä¸ºçŠ¶æ€å˜é‡ï¼Œå½“çŠ¶æ€å˜é‡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨æ›´æ–°è§†å›¾ã€‚æ˜¯æƒ³å®Œæˆå„ç§UIå˜åŒ–çš„<strong>åŸºçŸ³</strong></p>
<p>è€Œ<code>@Local</code>åˆ™æ˜¯ä¸ºäº†è§£å†³<code>@State</code>åœ¨å¤–éƒ¨åˆå§‹åŒ–æ—¶æ— æ³•å‡†ç¡®è¡¨è¾¾ç»„ä»¶å†…éƒ¨çŠ¶æ€ä¸èƒ½è¢«å¤–é¢ä¿®æ”¹çš„è¯­ä¹‰çš„é—®é¢˜ã€‚<br>è¿™ä¸ªé—®é¢˜å®˜æ–¹çš„æè¿°æœ‰äº›æŠ½è±¡ï¼Œæˆ‘ä¸¾ä¸ªä¾‹å­ï¼š</p>
<p>å‡è®¾æœ‰ä¸€ä¸ªè®¡æ•°å™¨ç»„ä»¶ï¼Œå†…éƒ¨æœ‰ä¸€ä¸ªçŠ¶æ€ count è¡¨ç¤ºå½“å‰çš„è®¡æ•°å€¼ã€‚å¦‚æœå¤–éƒ¨ä»£ç å¯ä»¥ç›´æ¥ä¿®æ”¹ countï¼Œå¯èƒ½ä¼šå¯¼è‡´è®¡æ•°å™¨çš„é€»è¾‘æ··ä¹±ã€‚æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯é€šè¿‡ç»„ä»¶æä¾›çš„æ¥å£ï¼ˆä¾‹å¦‚æ–¹æ³•æˆ–äº‹ä»¶ï¼‰æ¥é—´æ¥ä¿®æ”¹çŠ¶æ€ï¼Œè€Œä¸æ˜¯ç›´æ¥è®¿é—®å’Œä¿®æ”¹ countã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct <span class="title class_">LocalState</span> &#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">countChange</span>:<span class="built_in">number</span> = <span class="number">5</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">countChange</span>--</span><br><span class="line">    &#125;,<span class="number">500</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title function_">count</span>(&#123;<span class="attr">count</span>:<span class="variable language_">this</span>.<span class="property">countChange</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct count&#123;</span><br><span class="line">  <span class="meta">@State</span> <span class="attr">count</span>: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">count</span>.<span class="title function_">toString</span>())</span><br><span class="line">      .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">      .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2025/02/04/V2/2.png" alt="2"></p>
<p>è¿™æ®µä»£ç ä¸­æˆ‘ä»¬è®¾ç½®äº†è®¡æ•°å™¨ç»„ä»¶<code>count</code>çš„åˆå§‹å€¼ä¸º0ï¼Œç„¶ååœ¨<code>aboutToAppear</code>æ–¹æ³•ä¸­ä½¿ç”¨<code>setInterval</code>æ–¹æ³•æ¯éš”ä¸€ç§’é’Ÿå°†è®¡æ•°å™¨çš„å€¼åŠ 1ã€‚<br>ä½†æ˜¯ï¼Œè¿™æ®µä»£ç ä¸­å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¤–éƒ¨ä»£ç å¯ä»¥ä¿®æ”¹è®¡æ•°å™¨çš„åˆå§‹å€¼ã€‚</p>
<p><code>count(&#123;count:this.countChange&#125;)</code>è¿™è¡Œä»£ç å°†è®¡æ—¶å™¨çš„åˆå§‹å€¼è®¾ç½®ä¸ºäº†5ï¼Œä½†å¾ˆæ˜¾ç„¶è¿™ä¸ªç»„ä»¶çš„è®¾è®¡åˆè¡·æ˜¯ä¸æƒ³è®©å†…éƒ¨æ•°æ®è¢«å¤–éƒ¨ä¿®æ”¹çš„ã€‚<br>V1ç‰ˆæœ¬çš„çŠ¶æ€ç®¡ç†è™½ç„¶å¯ä»¥é€šè¿‡å…¶ä»–æ–¹å¼æ¥å®ç°è¿™ä¸ªç®€å•çš„åˆå§‹åŒ–åŠŸèƒ½ï¼Œä½†è¿™å¹¶ä¸åˆ©äºç»„ä»¶åŠŸèƒ½çš„å°è£…ã€‚<br>å› æ­¤ï¼ŒV2ç‰ˆæœ¬çš„çŠ¶æ€ç®¡ç†å¼•å…¥äº†<code>@Local</code>è£…é¥°å™¨ï¼Œå®ƒå¯ä»¥å°†ä¸€ä¸ªå˜é‡å£°æ˜ä¸ºæœ¬åœ°çŠ¶æ€å˜é‡ï¼Œåªèƒ½åœ¨ç»„ä»¶å†…éƒ¨è®¿é—®å’Œä¿®æ”¹ã€‚è¿™æ ·å¯ä»¥é¿å…å¤–éƒ¨ä»£ç ä¿®æ”¹ç»„ä»¶å†…éƒ¨çŠ¶æ€ï¼Œä»è€Œæé«˜ç»„ä»¶çš„å°è£…æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct <span class="title class_">LocalState</span> &#123;</span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">countChange</span>:<span class="built_in">number</span> = <span class="number">5</span></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">countChange</span>--</span><br><span class="line">    &#125;,<span class="number">500</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title function_">count</span>(&#123;<span class="attr">count</span>:<span class="variable language_">this</span>.<span class="property">countChange</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct count&#123;</span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">count</span>: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">    &#125;,<span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">count</span>.<span class="title function_">toString</span>())</span><br><span class="line">      .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">      .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2025/02/04/V2/3.png" alt="3"></p>
<p>ç”±æŠ¥é”™ä¿¡æ¯æˆ‘ä»¬å¯ä»¥æ¸…æ™°çš„çœ‹åˆ°<code>&#39;count&#39; cannot be initialized here</code>ï¼Œcountä¸èƒ½åœ¨è¿™é‡Œåˆå§‹åŒ–ã€‚<br>è¿™æ ·å°±å®ç°äº†æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p>
<div class="note danger flat"><p>è¦æ³¨æ„ï¼Œ<code>@Local</code>è£…é¥°å™¨å¹¶ä¸èƒ½åƒ<code>@State</code>ä¸€æ ·ç›‘è§†ç¬¬ä¸€å±‚å¯¹è±¡çš„çŠ¶æ€å˜åŒ–ï¼Œå½“ä½ <strong>ç›´æ¥ä¿®æ”¹<code>@Local</code>è£…é¥°å™¨ä¿®é¥°çš„å¯¹è±¡çš„å±æ€§æ—¶UIå¹¶ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼ï¼ï¼</strong><br>è¦é€‚å½“çš„é…åˆ<code>@ObserveV2</code>ä»¥åŠ<code>@Trace</code>å»è¿›è¡Œå¤æ‚ç±»å‹çš„æ•°æ®å˜åŒ–ã€‚</p>
</div>
<h3 id="Paramå’Œ-Once"><a href="#Paramå’Œ-Once" class="headerlink" title="@Paramå’Œ@Once"></a><code>@Param</code>å’Œ<code>@Once</code></h3><p>ä¸Šæ–‡è¯´åˆ°<code>@State</code>çš„ç¼ºé™·åœ¨äºæ— æ³•è§„èŒƒæ˜¯å¦å¯ä»¥å¤–éƒ¨åˆå§‹åŒ–çš„é—®é¢˜ã€‚<code>@Local</code>å¯ä»¥æœ‰æ•ˆåœ°é˜»éš”å¤–éƒ¨åˆå§‹åŒ–ï¼Œæ¥ä¿éšœè¯¥çŠ¶æ€å˜é‡ä»…ä¸ºæœ¬ç»„ä»¶å†…éƒ¨ä½¿ç”¨ã€‚<br>ä½†æˆ‘ä»¬ä¹Ÿç¡®å®ä¼šå­˜åœ¨å¤–éƒ¨åˆå§‹åŒ–çš„éœ€æ±‚ã€‚<br>V2ç‰ˆæœ¬çš„çŠ¶æ€ç®¡ç†å¼•å…¥äº†<code>@Param</code>å’Œ<code>@Once</code>è£…é¥°å™¨ã€‚</p>
<h4 id="Param"><a href="#Param" class="headerlink" title="@Param"></a><code>@Param</code></h4><p><code>@Param</code>ä¸<code>@Prop</code>çš„åŠŸèƒ½ç±»ä¼¼ï¼Œéƒ½æ˜¯å®šä¹‰ä¸€ä¸ªçŠ¶æ€å˜é‡ä»å¤–éƒ¨ä¼ å…¥ã€‚</p>
<p><strong>åŒºåˆ«ï¼š</strong></p>
<ol>
<li><code>@Prop</code>æ˜¯å•å‘ç»‘å®šï¼Œåªæœ‰çˆ¶ç»„ä»¶èƒ½å½±å“å­ç»„ä»¶ï¼Œå­ç»„ä»¶çš„<strong>ä¿®æ”¹</strong>æ— æ³•å½±å“çˆ¶ç»„ä»¶ã€‚</li>
<li><code>@Param</code>ä¹Ÿæ˜¯å•å‘ç»‘å®šï¼Œ<strong>ä½†æ˜¯</strong>åœ¨å­ç»„ä»¶å†…éƒ¨æ— æ³•å¯¹çŠ¶æ€å˜é‡è¿›è¡Œä¿®æ”¹ï¼Œåªèƒ½è¯»å–ï¼ï¼ï¼æ˜¯<code>readonly</code>çš„ã€‚</li>
<li>å¯¹äºå¤æ‚ç±»å‹å¦‚ç±»å¯¹è±¡ï¼Œ<code>@Param</code>ä¼šæ¥å—æ•°æ®æºçš„<strong>å¼•ç”¨(ç±»ä¼¼äºåœ°å€å€¼)</strong>ã€‚åœ¨ç»„ä»¶å†…å¯ä»¥ä¿®æ”¹ç±»å¯¹è±¡ä¸­çš„å±æ€§ï¼Œè¯¥ä¿®æ”¹<strong>ä¼šåŒæ­¥åˆ°æ•°æ®æº</strong>ã€‚</li>
<li>ç”±ç¬¬ä¸‰æ¡è¡ç”Ÿå‡ºçš„ä¸€ç‚¹å°±æ˜¯ï¼Œå¦‚æœå¦‚æœä¼ é€’çš„æ˜¯<strong>å¤æ‚å¯¹è±¡</strong>ä¸”éœ€è¦ä¸¥æ ¼çš„<strong>å•å‘</strong>æ•°æ®ç»‘å®šï¼Œåº”å½“å¯¹å¯¹è±¡è¿›è¡Œ<strong>æ·±æ‹·è´</strong>ï¼Œé˜²æ­¢å­ç»„ä»¶ä¿®æ”¹çˆ¶ç»„ä»¶çš„æ•°æ®ã€‚</li>
</ol>
<p>é’ˆå¯¹äºç®€å•ç±»å‹çš„å‰ä¸¤ç‚¹ä¸åŒå¯ä»¥é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥ç†è§£ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct <span class="title class_">LocalState</span> &#123;</span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">countChange</span>: <span class="built_in">number</span> = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">countChange</span>++</span><br><span class="line">    &#125;, <span class="number">5000</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">countChange</span>.<span class="title function_">toString</span>())</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">        .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">      <span class="title function_">count</span>(&#123; <span class="attr">count</span>: <span class="variable language_">this</span>.<span class="property">countChange</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line">struct count &#123;</span><br><span class="line">  <span class="meta">@Prop</span> <span class="attr">count</span>: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="title function_">aboutToAppear</span>(): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="built_in">setInterval</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">    &#125;, <span class="number">1000</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">count</span>.<span class="title function_">toString</span>())</span><br><span class="line">      .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">      .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<video width="100%" controls>
  <source src="4.mp4" type="video/mp4">
  æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ ‡ç­¾ã€‚
</video>

<p>è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†<code>@Prop</code>è£…é¥°å™¨æ¥å®šä¹‰ä¸€ä¸ªä»å¤–éƒ¨ä¼ å…¥çš„ç®€å•ç±»å‹çŠ¶æ€å˜é‡ã€‚åŒæ—¶ä¹Ÿå±•ç¤ºäº†V1V2ç‰ˆæœ¬æ··ç”¨çš„å¯è¡Œæ€§ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå½“çˆ¶ç»„ä»¶çš„<code>countChange</code>å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå­ç»„ä»¶çš„<code>count</code>ä¹Ÿä¼šéšä¹‹å˜åŒ–ã€‚<br>å¦‚æœå°†<code>@Prop</code>æ”¹ä¸º<code>@Param</code>ï¼Œåˆ™ä¼šå‡ºç°æŠ¥é”™ã€‚<br><img src="/2025/02/04/V2/5.png" alt="4"></p>
<p><code>Cannot assign to &#39;count&#39; because it is a read-only property.</code>è¿™ä¸ªæŠ¥é”™ä¿¡æ¯å‘Šè¯‰æˆ‘ä»¬ï¼Œ<code>count</code>æ˜¯ä¸€ä¸ªåªè¯»å±æ€§ï¼Œæ— æ³•ä¿®æ”¹ã€‚<br>è¿™ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå› ä¸º<code>@Param</code>æ˜¯å•å‘ç»‘å®šï¼Œå­ç»„ä»¶åªèƒ½è¯»å–çˆ¶ç»„ä»¶ä¼ å…¥çš„çŠ¶æ€å˜é‡ï¼Œè€Œä¸èƒ½ä¿®æ”¹ã€‚</p>
<p>ä½†é’ˆå¯¹äºåä¸¤ç‚¹æ¥è¯´å¯èƒ½ä¼šæœ‰ä¸€äº›è¿·æƒ‘ã€‚å·²ç»æ˜¯<code>Readonly</code>äº†ï¼Œä¸ºä»€ä¹ˆè¿˜å¯ä»¥ä¿®æ”¹ï¼Ÿ<br>åœ¨ç»è¿‡æˆ‘çš„å°è¯•åï¼Œå¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªä¾‹å­æ¥è¿›è¡Œè§£é‡Šï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>&#123;</span><br><span class="line">  <span class="meta">@Trace</span> <span class="keyword">private</span> <span class="attr">_name</span>: <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">set</span> <span class="title function_">name</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_name</span> = value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">get</span> <span class="title function_">name</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_name</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Trace</span> <span class="keyword">private</span> <span class="attr">_age</span>: <span class="built_in">number</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">set</span> <span class="title function_">age</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_age</span> = value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">get</span> <span class="title function_">age</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_age</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">age</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_name</span> = name</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_age</span> = age</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct <span class="title class_">LocalState</span> &#123;</span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">student</span>: <span class="title class_">Student</span> = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;A&#x27;</span>,<span class="number">10</span>)</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;name:&#x27;</span>+<span class="variable language_">this</span>.<span class="property">student</span>.<span class="property">name</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">        .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">      <span class="title function_">count</span>(&#123; <span class="attr">student</span>: <span class="variable language_">this</span>.<span class="property">student</span> &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct count &#123;</span><br><span class="line">  <span class="meta">@Param</span> <span class="attr">student</span>: <span class="title class_">Student</span> = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;B&#x27;</span>,<span class="number">10</span>)</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>()&#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;name:&#x27;</span>+<span class="variable language_">this</span>.<span class="property">student</span>.<span class="property">name</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">        .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">      <span class="title class_">Button</span>()</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">student</span>.<span class="property">name</span>=<span class="string">&#x27;C&#x27;</span></span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">student</span>.<span class="property">name</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<video width="100%" controls>
  <source src="6.mp4" type="video/mp4">
  æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ ‡ç­¾ã€‚
</video>

<div class="note warning flat"><p>æˆ‘ä»¬æ‰€ä¼ å…¥çš„å¹¶éæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œæ˜¯<strong>å¯¹è±¡çš„ç´¢å¼•</strong>å¯¹è±¡æœ¬èº«å­˜å‚¨äºå†…å­˜ä¸­å¹¶æ²¡æœ‰è¢«ä¼ å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰€è°“çš„<code>Readonly</code><strong>åªæ˜¯ä¼ å…¥çš„ç´¢å¼•æ˜¯åªè¯»</strong>ï¼Œè€Œå¹¶<strong>ä¸ä¼šé™åˆ¶é€šè¿‡ç´¢å¼•å¯¹è¯¥å¯¹è±¡è¿›è¡Œæ“ä½œ</strong>ï¼ï¼ï¼</p>
</div>
<p>å½“ä¼ å…¥çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–æ˜¯å…¶ä»–å¤æ‚ç±»å‹æ—¶ï¼Œå…¶å†…éƒ¨å¯èƒ½åŒ…å«æœ‰å†…ç½®å‡½æ•°å¯ä»¥è¢«å­ç»„ä»¶è°ƒç”¨å¹¶ä¿®æ”¹å…¶å±æ€§å€¼ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦ç”¨æ·±åº¦æ‹·è´çš„åŸå› ã€‚</p>
<p>è€Œä¿®æ­£ä¸Šé¢ä»£ç çš„æ–¹æ³•å°±æ˜¯æ·»åŠ å…‹éš†å‡½æ•°ã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>&#123;</span><br><span class="line">  <span class="meta">@Trace</span> <span class="keyword">private</span> <span class="attr">_name</span>: <span class="built_in">string</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">set</span> <span class="title function_">name</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_name</span> = value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">get</span> <span class="title function_">name</span>(): <span class="built_in">string</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_name</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Trace</span> <span class="keyword">private</span> <span class="attr">_age</span>: <span class="built_in">number</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">set</span> <span class="title function_">age</span>(<span class="params"><span class="attr">value</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_age</span> = value</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">get</span> <span class="title function_">age</span>(): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">_age</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">age</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_name</span> = name</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">_age</span> = age</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="title function_">clone</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="variable language_">this</span>.<span class="property">name</span>, <span class="variable language_">this</span>.<span class="property">age</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct <span class="title class_">LocalState</span> &#123;</span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">student</span>: <span class="title class_">Student</span> = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;A&#x27;</span>,<span class="number">10</span>)</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;name:&#x27;</span>+<span class="variable language_">this</span>.<span class="property">student</span>.<span class="property">name</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">        .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">      <span class="title function_">count</span>(&#123; <span class="attr">student</span>: <span class="variable language_">this</span>.<span class="property">student</span>.<span class="title function_">clone</span>() &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct count &#123;</span><br><span class="line">  <span class="meta">@Param</span> <span class="attr">student</span>: <span class="title class_">Student</span> = <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="string">&#x27;B&#x27;</span>,<span class="number">10</span>)</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>()&#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;name:&#x27;</span>+<span class="variable language_">this</span>.<span class="property">student</span>.<span class="property">name</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">        .<span class="title function_">fontWeight</span>(<span class="title class_">FontWeight</span>.<span class="property">Bold</span>)</span><br><span class="line">      <span class="title class_">Button</span>()</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">student</span>.<span class="property">name</span>=<span class="string">&#x27;C&#x27;</span></span><br><span class="line">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">student</span>.<span class="property">name</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2025/02/04/V2/7.png" alt="7"></p>
<p>è¿™æ ·å°±å®ç°äº†æ·±åº¦æ‹·è´ï¼Œå°†å­ç»„ä»¶æ— æ³•å†åå‘å½±å“çˆ¶ç»„ä»¶ã€‚ä¿éšœæ•°æ®å®‰å…¨æ€§ã€‚</p>
<h4 id="Once"><a href="#Once" class="headerlink" title="@Once"></a><code>@Once</code></h4><p>è¿™ä¸ªè£…é¥°å™¨ä¸V1å¹¶æ— æ˜ç¡®å¯¹åº”å…³ç³»ï¼Œè€Œä¸”å¹¶ä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œèƒ½ä¸”ä»…èƒ½ä¸<code>@Param</code>é…åˆä½¿ç”¨ã€‚æ¥å®ç°<code>@State</code>çš„å•æ¬¡å¤–éƒ¨åˆå§‹åŒ–çš„æ•ˆæœã€‚<br>å¯ä»¥å‚è€ƒä¸‹æ–¹ç¤ºä¾‹ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct <span class="title class_">Once1</span> &#123;</span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">num</span>:<span class="built_in">number</span> = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">num</span>.<span class="title function_">toString</span>())</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">60</span>)</span><br><span class="line">        .<span class="title function_">fontWeight</span>(<span class="number">700</span>)</span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;num++&#x27;</span>)</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">num</span>++</span><br><span class="line">        &#125;)</span><br><span class="line">      <span class="title function_">num</span>(&#123;<span class="attr">num</span>:<span class="variable language_">this</span>.<span class="property">num</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct num&#123;</span><br><span class="line">  <span class="meta">@Param</span><span class="meta">@Once</span> <span class="attr">num</span>:<span class="built_in">number</span> = -<span class="number">1</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>()&#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;å­ç»„ä»¶&#x27;</span>+<span class="variable language_">this</span>.<span class="property">num</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">60</span>)</span><br><span class="line">        .<span class="title function_">fontWeight</span>(<span class="number">700</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<video width="100%" controls>
  <source src="8.mp4" type="video/mp4">
  æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ ‡ç­¾ã€‚
</video>

<p>å½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œçˆ¶ç»„ä»¶çš„<code>num</code>ä¼šå‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯å­ç»„ä»¶çš„<code>num</code>ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚è¿™å°±æ˜¯å•æ¬¡å¤–éƒ¨åˆå§‹åŒ–çš„æ•ˆæœã€‚</p>
<h2 id="Linkå’Œ-Eventã€-Param"><a href="#Linkå’Œ-Eventã€-Param" class="headerlink" title="@Linkå’Œ@Eventã€@Param"></a><code>@Link</code>å’Œ<code>@Event</code>ã€<code>@Param</code></h2><p>åœ¨V1ç‰ˆæœ¬çš„çŠ¶æ€ç®¡ç†ä¸­ï¼Œå®ç°æ•°æ®åŒå‘åŒæ­¥æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯ç›´æ¥é€šè¿‡<code>@link</code>æ¥è¿›è¡Œç»‘å®šï¼Œè¿˜æœ‰å°±æ˜¯é¢„ç•™ç»„ä»¶å†…ç½®å‡½æ•°ï¼Œå°†éœ€è¦ä¼ å‡ºçš„æ•°æ®æš´éœ²å‡ºå»ã€‚<br>è€Œåœ¨V2ç‰ˆæœ¬ä¸­ï¼Œå®˜æ–¹æ¨èä½¿ç”¨<code>@Event</code>æ¥è¿›è¡Œæ•°æ®çš„<strong>åŒå‘ç»‘å®š</strong>ã€‚</p>
<p>å¯¹äº<code>@Event</code>ï¼Œå®˜æ–¹çš„æè¿°æ˜¯è¿™æ ·çš„ï¼š<br><img src="/2025/02/04/V2/9.png" alt="9"></p>
<p>enmâ€¦â€¦æœ‰ä¸€è¯´ä¸€æˆ‘ç°åœ¨å¹¶ä¸å¤ªç†è§£ä¸ºä»€ä¹ˆè¦æŠŠåŒå‘ç»‘å®šçš„åŠŸèƒ½åˆ æ‰ï¼Œå˜æˆç”¨å‡½æ•°çš„å‚æ•°æš´éœ²æ•°æ®çš„æ–¹å¼ã€‚</p>
<p>ä½†æ—¢ç„¶ç°åœ¨å®˜æ–¹é€‰æ‹©äº†è¿™ç§æ–¹å¼ï¼Œåº”è¯¥æ˜¯<code>@Link</code>å­˜åœ¨ä¸€äº›åº•å±‚é€»è¾‘ä¸Šçš„é”™è¯¯ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿè¦å»å­¦ä¹ <code>@Event</code>åŸºæœ¬çš„ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥å‚è€ƒä¸‹é¢çš„æ¡ˆä¾‹ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct <span class="title class_">EventTest</span> &#123;</span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">num</span>:<span class="built_in">number</span> = <span class="number">0</span></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">num</span>.<span class="title function_">toString</span>())</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">60</span>)</span><br><span class="line">        .<span class="title function_">fontWeight</span>(<span class="number">700</span>)</span><br><span class="line">      <span class="title function_">num2</span>(&#123;</span><br><span class="line">        <span class="attr">num</span>:<span class="variable language_">this</span>.<span class="property">num</span>,</span><br><span class="line">        <span class="attr">changeNum</span>:<span class="function">(<span class="params"><span class="attr">a</span>:<span class="built_in">number</span></span>)=&gt;</span>&#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">num</span> = a</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">justifyContent</span>(<span class="title class_">FlexAlign</span>.<span class="property">Center</span>)</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct num2&#123;</span><br><span class="line">  <span class="meta">@Param</span> <span class="attr">num</span>:<span class="built_in">number</span> = -<span class="number">1</span></span><br><span class="line">  <span class="meta">@Event</span> <span class="attr">changeNum</span>:<span class="function">(<span class="params"><span class="attr">a</span>:<span class="built_in">number</span></span>)=&gt;</span><span class="built_in">void</span> = <span class="function">(<span class="params"><span class="attr">a</span>:<span class="built_in">number</span></span>)=&gt;</span>&#123;&#125;</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>()&#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">&#x27;å­ç»„ä»¶&#x27;</span>+<span class="variable language_">this</span>.<span class="property">num</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">60</span>)</span><br><span class="line">        .<span class="title function_">fontWeight</span>(<span class="number">700</span>)</span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;++&#x27;</span>)</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="title function_">changeNum</span>(<span class="variable language_">this</span>.<span class="property">num</span>+<span class="number">1</span>)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">backgroundColor</span>(<span class="title class_">Color</span>.<span class="property">Orange</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<video width="100%" controls>
  <source src="10.mp4" type="video/mp4">
  æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ ‡ç­¾ã€‚
</video>

<h3 id="åŒå‘ç»‘å®šè¯­æ³•ç³–"><a href="#åŒå‘ç»‘å®šè¯­æ³•ç³–" class="headerlink" title="åŒå‘ç»‘å®šè¯­æ³•ç³–!!"></a>åŒå‘ç»‘å®šè¯­æ³•ç³–<code>!!</code></h3><p>åœ¨åç»­çš„å¼€å‘ä¸­æˆ‘å‘ç°å¯ä»¥ä½¿ç”¨<code>@Event</code>é…åˆè¯­æ³•ç³–<code>!!</code>æ¥å®ç°åŒå‘ç»‘å®šï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">value</span>: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.value&#125;</span>`</span>)</span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">`change value`</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span>++;</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="title class_">Star</span>(&#123; <span class="attr">value</span>: <span class="variable language_">this</span>.<span class="property">value</span>!! &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct <span class="title class_">Star</span> &#123;</span><br><span class="line">  <span class="meta">@Param</span> <span class="attr">value</span>: <span class="built_in">number</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="meta">@Event</span> <span class="attr">$value</span>: <span class="function">(<span class="params"><span class="attr">val</span>: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">void</span> = <span class="function">(<span class="params"><span class="attr">val</span>: <span class="built_in">number</span></span>) =&gt;</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="string">`<span class="subst">$&#123;<span class="variable language_">this</span>.value&#125;</span>`</span>)</span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">`change value `</span>).<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.$value(<span class="number">10</span>);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2025/02/04/V2/13.png" alt="13"></p>
<p>æˆ‘æœ¬æ¥ä»¥ä¸ºV2ç‰ˆæœ¬çš„åŒå‘ç»‘å®šéœ€è¦åƒV1ç‰ˆæœ¬é‚£æ ·æ‰‹åŠ¨å¤„ç†å­ç»„ä»¶æš´éœ²å‡ºå»çš„æ•°æ®ï¼Œä½†å®é™…ä¸Šå®˜æ–¹ç‰¹æ„æ³¨æ˜äº†åœ¨<code>@Event</code>ä¿®é¥°çš„å‡½æ•°æ²¡æœ‰è¢«åˆå§‹åŒ–æ—¶ï¼Œä¼šè‡ªåŠ¨åˆå§‹åŒ–ä¸€ä¸ªç©ºå‡½æ•°ã€‚<br>è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ç”¨<code>!!</code>æ¥è¿›è¡ŒåŒå‘ç»‘å®šäº†ã€‚</p>
<p><code>@Event $value: (val: number) =&gt; void = (val: number) =&gt; &#123;&#125;;</code>è¿™è¡Œä»£ç æ˜¯å¿…é¡»çš„ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚è¿™æ˜¯å°†æ•°æ®æš´éœ²å‡ºå»çš„å…³é”®æ­¥éª¤ã€‚</p>
<h2 id="Watchå’Œ-Monitor"><a href="#Watchå’Œ-Monitor" class="headerlink" title="@Watchå’Œ@Monitor"></a><code>@Watch</code>å’Œ<code>@Monitor</code></h2><div class="note info flat"><p>è¿™ä¸¤ä»£ç›‘å¬å™¨çš„åŠŸèƒ½åŸºæœ¬ä¸€è‡´ï¼Œéƒ½æ˜¯åœ¨çŠ¶æ€å˜é‡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ‰§è¡Œå›è°ƒå‡½æ•°ã€‚<br>å…¶æœ€å¤§çš„åŒºåˆ«åœ¨äºè£…é¥°å™¨ç»‘å®šçš„å¯¹è±¡ä¸åŒã€‚</p>
</div>
<p><code>@Watch</code>æ˜¯ç»‘å®šåœ¨<strong>å˜é‡</strong>ä¸Šçš„ï¼Œå½“å˜é‡å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¼šæ‰§è¡Œ<code>@Watch</code>å‚æ•°æŒ‡å‘çš„å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@State</span> <span class="meta">@Watch</span>(<span class="string">&#x27;onNumChange&#x27;</span>) <span class="attr">num</span>: <span class="built_in">number</span> = <span class="number">1</span></span><br><span class="line"><span class="title function_">onNumChange</span>(<span class="params"><span class="attr">changedPropertyName</span>: <span class="built_in">string</span></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">num</span>.<span class="title function_">toString</span>())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>@Monitor</code>æ˜¯ç»‘å®šåœ¨<strong>æ–¹æ³•</strong>ä¸Šçš„ï¼Œå½“<code>@Monitor</code>å‚æ•°æŒ‡å‘çš„ä¸€ä¸ªæˆ–å¤šä¸ªçŠ¶æ€å˜é‡å˜åŒ–æ—¶ï¼Œä¼šæ‰§è¡Œ<code>@Monitor</code>è£…é¥°çš„å›è°ƒå‡½æ•°ã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct <span class="title class_">MonitorTest</span> &#123;</span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">num</span>: <span class="built_in">number</span> = <span class="number">1</span></span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">num2</span>: <span class="built_in">number</span> = <span class="number">2</span></span><br><span class="line">  <span class="meta">@Monitor</span>(<span class="string">&#x27;num&#x27;</span>,<span class="string">&#x27;num2&#x27;</span>)</span><br><span class="line">  <span class="title function_">onNumChange</span>(<span class="params"><span class="attr">monitor</span>: <span class="title class_">IMonitor</span></span>) &#123;</span><br><span class="line">    monitor.<span class="property">dirty</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params"><span class="attr">path</span>: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;path&#125;</span> changed from <span class="subst">$&#123;monitor.value(path)?.before&#125;</span> to <span class="subst">$&#123;monitor.value(path)?.now&#125;</span>`</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;__________________________________________&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Button</span>(<span class="string">&#x27;++&#x27;</span>)</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">num</span>++</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">num2</span>++</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    .<span class="title function_">height</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">    .<span class="title function_">width</span>(<span class="string">&#x27;100%&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<video width="100%" controls>
  <source src="11.mp4" type="video/mp4">
  æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ ‡ç­¾ã€‚
</video>

<h2 id="AppStorageV2å’ŒPersistenceV2"><a href="#AppStorageV2å’ŒPersistenceV2" class="headerlink" title="AppStorageV2å’ŒPersistenceV2"></a>AppStorageV2å’ŒPersistenceV2</h2><p>AppStorageV2æ˜¯ä¸€ä¸ª<strong>å…¨å±€çŠ¶æ€ç®¡ç†</strong>çš„è£…é¥°å™¨ï¼Œå®ƒå¯ä»¥å°†ä¸€ä¸ªå˜é‡å£°æ˜ä¸ºå…¨å±€çŠ¶æ€å˜é‡ï¼Œåœ¨æ•´ä¸ªåº”ç”¨ç¨‹åºä¸­å…±äº«å’Œè®¿é—®ã€‚<br>PersistenceV2æ˜¯ä¸€ä¸ª<strong>æœ¬åœ°æŒä¹…åŒ–</strong>çš„è£…é¥°å™¨ï¼Œå®ƒå¯ä»¥å°†ä¸€ä¸ªå˜é‡å£°æ˜ä¸ºæœ¬åœ°æŒä¹…åŒ–å˜é‡ï¼Œåœ¨åº”ç”¨ç¨‹åºä¸­ä¿å­˜å’Œè¯»å–ã€‚<br>è¿™ä¸¤è€…çš„åŠŸèƒ½ä¸å…¶æœ¬èº«çš„V1ç‰ˆæœ¬å…¶å®åŒºåˆ«ä¸å¤§ï¼Œä½†æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ol>
<li>åœ¨<strong>V1</strong>ç‰ˆæœ¬ä¸­ï¼Œä¸€ä¸ªé”®å€¼åœ¨PersistentStorageä¸­åˆå§‹åŒ–è¿‡å°±ä¼šè‡ªåŠ¨åœ¨AppStorageä¸­åˆå§‹åŒ–è¯¥é”®å€¼ã€‚è€Œåœ¨<strong>V2</strong>ç‰ˆæœ¬ä¸­ï¼Œä¸¤è€…åˆå§‹åŒ–é”®å€¼<strong>ä¸äº’é€š</strong>ï¼Œæ˜¯ç‹¬ç«‹çš„ä¸¤ä¸ªåŠŸèƒ½ã€‚</li>
<li>åœ¨<strong>V1</strong>ç‰ˆæœ¬ä¸­ï¼Œä¸¤è€…çš†æœ‰å¤šä¸ªAPIæ¥å£å¯ä»¥åŒºåˆ†åˆ›å»ºã€è°ƒç”¨ã€é“¾æ¥ç­‰åŠŸèƒ½ã€‚è€Œåœ¨<strong>V2</strong>ç‰ˆæœ¬ä¸­åˆ›å»ºã€è°ƒç”¨ã€é“¾æ¥éƒ½åˆæˆåˆ°äº†<code>connect</code>ä¸­ã€‚è€Œè¿™å°±æ„å‘³ç€ä½ ä¼ å…¥ä¸åŒçš„å‚æ•°æ•°é‡ï¼Œä»¥åŠä¸åŒçš„å‚æ•°ç±»å‹å°±ä¼šæœ‰ä¸åŒçš„åŠŸèƒ½ã€‚</li>
<li>åœ¨<strong>V2</strong>ç‰ˆæœ¬ä¸­ï¼ŒPersistentV2æ”¯æŒè¿½è¸ª<strong>å¤šå±‚åµŒå¥—çš„å¯¹è±¡</strong>ï¼Œä¹Ÿå¯ä»¥è¿½è¸ª<strong>å¯¹è±¡æ•°ç»„</strong>ï¼Œä½†åœ¨è¿½è¸ªå¯¹è±¡æ•°ç»„æ—¶è¦æ³¨æ„ï¼Œæœ€å¤–å±‚åªèƒ½æ˜¯Classå¯¹è±¡ï¼ŒåŒæ—¶è¦é…åˆ<code>@Type</code>è£…é¥°å™¨ä½¿ç”¨ã€‚</li>
</ol>
<p>é’ˆå¯¹äºä¸Šè¿°å‡ ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒä»¥ä¸‹ç¤ºä¾‹ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">AppStorageV2</span>, <span class="title class_">PersistenceV2</span>, <span class="title class_">Type</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;@kit.ArkUI&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">People</span> &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="meta">@Trace</span> <span class="attr">age</span>: <span class="built_in">number</span></span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">name</span>: <span class="built_in">string</span>, <span class="attr">age</span>: <span class="built_in">number</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ObservedV2</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span> &#123;</span><br><span class="line">  <span class="meta">@Type</span>(<span class="title class_">Array</span>)</span><br><span class="line">  <span class="attr">peoples</span>: <span class="title class_">People</span>[] = [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">People</span>(<span class="string">&#x27;A&#x27;</span>, <span class="number">1</span>),</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">People</span>(<span class="string">&#x27;B&#x27;</span>, <span class="number">2</span>),</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="attr">peoples</span>: <span class="title class_">People</span>[]</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">peoples</span> = peoples</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> peoplesTest = <span class="keyword">new</span> <span class="title class_">Human</span>([<span class="keyword">new</span> <span class="title class_">People</span>(<span class="string">&#x27;A&#x27;</span>, <span class="number">1</span>),<span class="keyword">new</span> <span class="title class_">People</span>(<span class="string">&#x27;B&#x27;</span>, <span class="number">2</span>)])</span><br><span class="line"><span class="keyword">let</span> peoplesTest2 = <span class="keyword">new</span> <span class="title class_">Human</span>([<span class="keyword">new</span> <span class="title class_">People</span>(<span class="string">&#x27;C&#x27;</span>, <span class="number">3</span>),<span class="keyword">new</span> <span class="title class_">People</span>(<span class="string">&#x27;D&#x27;</span>, <span class="number">4</span>)])</span><br><span class="line"><span class="title class_">PersistenceV2</span>.<span class="title function_">connect</span>(<span class="title class_">Human</span>, <span class="string">&#x27;peoples&#x27;</span>, <span class="function">() =&gt;</span> peoplesTest)</span><br><span class="line"><span class="title class_">AppStorageV2</span>.<span class="title function_">connect</span>(<span class="title class_">Human</span>,<span class="string">&#x27;peoples&#x27;</span>,<span class="function">()=&gt;</span> peoplesTest2)</span><br><span class="line"><span class="meta">@Entry</span></span><br><span class="line"><span class="meta">@ComponentV2</span></span><br><span class="line">struct <span class="title class_">Index</span> &#123;</span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">peoples</span>: <span class="title class_">Human</span> = <span class="title class_">PersistenceV2</span>.<span class="title function_">connect</span>(<span class="title class_">Human</span>,<span class="string">&#x27;peoples&#x27;</span>)!</span><br><span class="line">  <span class="meta">@Local</span> <span class="attr">peoples2</span>:<span class="title class_">Human</span> = <span class="title class_">AppStorageV2</span>.<span class="title function_">connect</span>(<span class="title class_">Human</span>,<span class="string">&#x27;peoples&#x27;</span>)!</span><br><span class="line">  <span class="title function_">build</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title class_">Column</span>() &#123;</span><br><span class="line">      <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">peoples</span>.<span class="property">peoples</span>[<span class="number">0</span>].<span class="property">age</span> + <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">      <span class="title class_">Text</span>(<span class="variable language_">this</span>.<span class="property">peoples2</span>.<span class="property">peoples</span>[<span class="number">0</span>].<span class="property">age</span> + <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        .<span class="title function_">fontSize</span>(<span class="number">50</span>)</span><br><span class="line">      <span class="title class_">Button</span>()</span><br><span class="line">        .<span class="title function_">onClick</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">peoples</span>.<span class="property">peoples</span>[<span class="number">0</span>].<span class="property">age</span>++</span><br><span class="line">          <span class="variable language_">this</span>.<span class="property">peoples2</span>.<span class="property">peoples</span>[<span class="number">0</span>].<span class="property">age</span>++</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<video width="100%" controls>
  <source src="12.mp4" type="video/mp4">
  æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ ‡ç­¾ã€‚
</video>

<p>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ç‰¹æ„å°†ä¸¤ä¸ªHumanå¯¹è±¡çš„é”®å€¼è®¾ç½®ä¸º<strong>ç›¸åŒ</strong>çš„<code>&#39;peoples&#39;</code>ï¼Œå†é€šè¿‡å®é™…è·å–çš„æ•°å€¼è¯æ˜äº†PersistentV2å’ŒAppStorageV2çš„åŠŸèƒ½æ˜¯<strong>ç‹¬ç«‹</strong>çš„ã€‚</p>
<p>è€Œæˆ‘ä¸ºäº†å®ç°<code>People[]</code>å¯¹è±¡æ•°ç»„çš„æŒä¹…åŒ–å­˜å‚¨ï¼Œæˆ‘ç‰¹æ„åˆ©ç”¨<code>Human</code>å¯¹è±¡åŒ…è£¹ä½<code>People[]</code>å¹¶ä½œä¸ºäº†PersistentV2å’ŒAppStorageV2çš„å‚æ•°ï¼Œè¿™æ ·å°±å¯ä»¥å®ç°å¤šå±‚åµŒå¥—çš„å¯¹è±¡çš„æŒä¹…åŒ–å­˜å‚¨ã€‚å¦åˆ™ç›´æ¥æŒä¹…åŒ–<code>People[]</code>ä¼šæŠ¥é”™ã€‚</p>
<p>åŒæ ·çš„<code>connect</code>æ¥å£åœ¨ä¼ å…¥ä¸åŒå‚æ•°æ—¶çš„æ•ˆæœä¸åŒã€‚è¿™é‡Œä¸ä¸€ä¸€æ’åˆ—ç»„åˆäº†ï¼Œåªè¯´ä¸€ä¸‹æ˜¯å®æµ‹æœ€è§„èŒƒçš„ä½¿ç”¨æ–¹å¼ã€‚</p>
<p><code>connect</code>æ¥å£å¯ä»¥ä¼ ä¸‰ä¸ªå‚æ•°ï¼Œåˆ†åˆ«æ˜¯ï¼š</p>
<ol>
<li>è¦å­˜å‚¨çš„ç±»å‹</li>
<li>è¦å­˜å‚¨çš„é”®å€¼ï¼ˆstringç±»å‹ï¼‰</li>
<li>åˆå§‹åŒ–æ„é€ å™¨ï¼ˆ()=&gt;åˆå§‹åŒ–æ•°å€¼ï¼‰</li>
</ol>
<p>åœ¨ç¬¬ä¸€æ¬¡å­˜å‚¨è¯¥é”®å€¼è¦è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œä¸‰ä¸ªå‚æ•°å‡éœ€ä¼ é€’ã€‚<br>è€Œåœ¨ä¹‹åè·å–è¯¥é”®å€¼å¯¹çš„é“¾æ¥æ—¶ï¼Œåªéœ€è¦ä¼ å…¥å‰ä¸¤ä¸ªå‚æ•°å³å¯ã€‚</p>
<div class="note danger flat"><p><strong>æ³¨æ„</strong>ï¼šåœ¨æµ‹è¯•è¿‡ç¨‹ä¸­æˆ‘å‘ç°UIä¸­æœ‰ä½¿ç”¨å†…ç½®çš„JSONè§£æå‡½æ•°çš„ç»„ä»¶æ–‡æœ¬æ—¶ï¼Œä¿®æ”¹<code>AppStorageV2</code>å’Œ<code>PersistenceV2</code>ä¸­çš„å€¼<strong>ä¸ä¼šå¼•å‘UIçš„æ›´æ–°</strong>ã€‚ä½†é€šè¿‡æ‰“å°æ—¥å¿—å’Œé‡å¯åº”ç”¨ç­‰æ–¹å¼å¯ä»¥å‘ç°æ•°æ®å·²ç»<strong>å‘ç”Ÿäº†å˜åŒ–</strong>ã€‚è¿™è¯´æ˜JSONçš„å†…ç½®è§£æå‡½æ•°åªä¼šåœ¨<strong>æ„å»ºé¡µé¢æ—¶</strong>è®¡ç®—ä¸€æ¬¡ï¼Œè€Œä¸ä¼šåœ¨æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°è®¡ç®—ã€‚</p>
</div>
<p>è¿™ä¸€ç‚¹ä¸V2ç‰ˆæœ¬æ–°å¢çš„<code>@Computed</code>ä¸åŒï¼Œ<code>@Computed</code>ä¼šåœ¨<strong>çŠ¶æ€å˜é‡</strong>çš„æ•°æ®å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°è®¡ç®—ã€‚<br><strong>ä»…åœ¨çŠ¶æ€å˜é‡å˜åŒ–æ—¶é‡æ–°è®¡ç®—ï¼ï¼ï¼å¸¸è§„å˜é‡ä¸ä¼šè§¦å‘ï¼ï¼ï¼</strong></p>
<h2 id="è¡¥å……"><a href="#è¡¥å……" class="headerlink" title="è¡¥å……"></a>è¡¥å……</h2><p>åœ¨åç»­å¼€å‘é¢è¯•é€šé¡¹ç›®æ—¶æˆ‘å‘ç°V2ç‰ˆæœ¬çš„AppStorageV2åœ¨å­˜å‚¨å¾ˆå¤šç³»ç»Ÿå†…ç½®çš„å¯¹è±¡æ¯”å¦‚åº”ç”¨ä¸Šä¸‹æ–‡å¯¹è±¡<code>Context</code>æ—¶æ— æ³•ç›´æ¥å­˜å‚¨ï¼Œæˆ‘ä»¬æ— æ³•åœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸­ä¼ å…¥ä¸€ä¸ªåˆæ³•çš„ç±»å‹ï¼Œè¿™çœŸçš„å¾ˆå¥‡æ€ªã€‚</p>
<p>ç›®å‰æˆ‘çš„è§£å†³æ–¹å¼å°±æ˜¯å°†æ— æ³•ç›´æ¥å­˜å‚¨çš„å¯¹è±¡åŒ…è£…è¿›ä¸€ä¸ªè‡ªå®šä¹‰ç±»çš„å±æ€§ä¸­ï¼Œç„¶ååœ¨è¿›è¡Œå­˜å‚¨ã€‚</p>
<div class="note success flat"><p>è¿˜æœ‰ä¸€äº›ç®€å•ç±»å‹åœ¨åšæŒä¹…åŒ–ä»¥åŠå…¨å±€å˜é‡çš„å®šä¹‰æ—¶éƒ½ä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œæˆ‘çš„å»ºè®®å°±æ˜¯<strong>ä¹‹è¦æ˜¯æ— æ³•æ­£å¸¸å­˜å‚¨çš„æƒ…å†µå°±éƒ½åŒ…è£¹ä¸€å±‚å¯¹è±¡è¯•è¯•</strong>ï¼Œå†é…åˆä¸Š<code>@ObservedV2</code>å’Œ<code>@Trace</code>çš„æ— é™åµŒå¥—å±‚æ•°è¿½è¸ªèƒ½åŠ›ï¼ŒåŸºæœ¬ä¸Šå°±å¯ä»¥è§£å†³å¤§éƒ¨åˆ†é—®é¢˜ã€‚</p>
</div>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å•Šå…ˆå†™åˆ°è¿™å§ï¼ŒV2ç‰ˆæœ¬çš„æ–‡æ¡£å¶å°”è¿˜æ˜¯æœ‰ä¸€äº›è°œè¯­äººæˆ–è€…è¯´æ˜¯å¯èƒ½å­˜åœ¨æ­§ä¹‰çš„åœ°æ–¹ï¼Œä½†è¿™ä¹Ÿæ˜¯å¤§å¤šæ•°å®˜æ–¹æ–‡æ¡£éƒ½ä¼šå­˜åœ¨ä¸€ç‚¹çš„å°é—®é¢˜æ— ä¼¤å¤§é›…ã€‚<br>å­¦ä¹ ä»»ä½•ä¸€é—¨æŠ€æœ¯æ€»å½’è¿˜æ˜¯å¾—è‡ªå·±å°è¯•ä¹‹åï¼ŒæŠŠè‡ªå·±æƒ³åˆ°çš„ä½¿ç”¨åœºæ™¯éƒ½è¯•ä¸€éï¼Œæ‰èƒ½æ¸…æ¥šä»–çš„ç‰¹æ€§å’Œæ³¨æ„ç‚¹ã€‚</p>
<p>åŒæ—¶å†å†™è¿™ç¯‡åšå®¢çš„æ—¶å€™ä¹Ÿå­¦ä¼šäº†åœ¨mdä¸­å¤–æŒ‚HTMLæ ‡ç­¾çš„æ–¹å¼ï¼Œç›¸ä¿¡ä»¥åæˆ‘çš„åšå®¢ä¼šæœ‰æ›´å¤šæ–°é²œç©æ„åŠ å…¥è¿›æ¥ã€‚</p>
<p>æœ€åä¹Ÿæ„Ÿè°¢ä½ èƒ½çœ‹åˆ°è¿™é‡Œï¼Œç›¸ä¿¡ä½ ä¹Ÿä¸€å®šæ˜¯ä¸ªçˆ±æŠ€æœ¯çˆ±ç”Ÿæ´»çš„äººï¼Œæ‹œæ‹œå’¯~ :)</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://github.com/XBXyftx">XBXyftx</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://xbxyftx.top">https://xbxyftx.top</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æ­¤æ–‡ç« ç‰ˆæƒå½’XBXyftxæ‰€æœ‰ï¼Œå¦‚æœ‰è½¬è½½ï¼Œè¯·è¨»æ˜æ¥è‡ªåŸä½œè€…</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E9%B8%BF%E8%92%99/">é¸¿è’™</a><a class="post-meta__tags" href="/tags/%E6%8A%80%E6%9C%AF%E5%90%91/">æŠ€æœ¯å‘</a><a class="post-meta__tags" href="/tags/V2/">V2</a></div><div class="post-share"><div class="social-share" data-image="/img/ArticleTopImgs/V2TopImg.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://lib.baomitu.com/social-share.js/1.0.16/css/share.min.css" media="print" onload="this.media='all'"><script src="https://lib.baomitu.com/social-share.js/1.0.16/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/01/30/%E5%BC%80%E5%BF%83%E4%B8%80%E7%AC%91%E9%A1%B9%E7%9B%AE%E7%AC%94%E8%AE%B0/" title="å¼€å¿ƒä¸€ç¬‘é¡¹ç›®ç¬”è®°"><img class="cover" src="/img/ArticleTopImgs/JokeTopImg.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">ä¸Šä¸€ç¯‡</div><div class="info-item-2">å¼€å¿ƒä¸€ç¬‘é¡¹ç›®ç¬”è®°</div></div><div class="info-2"><div class="info-item-1">ä¸‹æ‹‰åˆ·æ–°ä¸è§¦åº•åŠ è½½é€»è¾‘çš„ç»ƒä¹ é¡¹ç›®</div></div></div></a><a class="pagination-related" href="/2025/02/08/%E6%88%91%E7%9A%84%E4%B9%A6%E6%9E%B6%E9%A1%B9%E7%9B%AE%E7%AC%94%E8%AE%B0/" title="æˆ‘çš„ä¹¦æ¶é¡¹ç›®ç¬”è®°"><img class="cover" src="/img/ArticleTopImgs/BookShelfTopImg.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">ä¸‹ä¸€ç¯‡</div><div class="info-item-2">æˆ‘çš„ä¹¦æ¶é¡¹ç›®ç¬”è®°</div></div><div class="info-2"><div class="info-item-1">ä¸€ä¸ªå¯¹åˆ©ç”¨NetWork Kitå‘é€HTTPè¯·æ±‚çš„å®æˆ˜ç»ƒä¹ é¡¹ç›®</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/03/31/%E2%80%9CHongXiaoYi%E2%80%9D/" title="é¸¿å°æ˜“é¡¹ç›®å¼€å‘ç¬”è®°"><img class="cover" src="/img/ArticleTopImgs/hxyTopImg.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-31</div><div class="info-item-2">é¸¿å°æ˜“é¡¹ç›®å¼€å‘ç¬”è®°</div></div><div class="info-2"><div class="info-item-1">é¸¿å°æ˜“ï¼Œä½ çš„é¸¿è’™å¼€å‘å¥½å¸®æ‰‹ã€‚</div></div></div></a><a class="pagination-related" href="/2025/05/14/AccountKitTest/" title="åä¸ºè´¦æˆ·ä¸€é”®ç™»å½•åŠŸèƒ½æµ‹è¯•"><img class="cover" src="/img/ArticleTopImgs/AccountTopImg.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-14</div><div class="info-item-2">åä¸ºè´¦æˆ·ä¸€é”®ç™»å½•åŠŸèƒ½æµ‹è¯•</div></div><div class="info-2"><div class="info-item-1">Account Kitçš„å®˜æ–¹demoæµ‹è¯•ä¸åä¸ºè´¦æˆ·ç™»å½•çš„åŠŸèƒ½å®ç°åˆ†æã€‚</div></div></div></a><a class="pagination-related" href="/2025/03/16/yiDuo/" title="å…³äºé¸¿è’™çš„ä¸€å¤šèƒ½åŠ›"><img class="cover" src="/img/ArticleTopImgs/yiduoTopImg.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-16</div><div class="info-item-2">å…³äºé¸¿è’™çš„ä¸€å¤šèƒ½åŠ›</div></div><div class="info-2"><div class="info-item-1">ä¸€å¤šèƒ½åŠ›çš„å­¦ä¹ ç¬”è®°</div></div></div></a><a class="pagination-related" href="/2025/03/13/Navigation/" title="Navigationä¸NavDestination"><img class="cover" src="/img/ArticleTopImgs/NavTopImg.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-13</div><div class="info-item-2">Navigationä¸NavDestination</div></div><div class="info-2"><div class="info-item-1">æœ¬æ–‡å°†ä»‹ç»Navigationä¸NavDestinationçš„ä½¿ç”¨æ–¹æ³•ã€‚</div></div></div></a><a class="pagination-related" href="/2025/03/11/MianShiTong2/" title="é¢è¯•é€šé¡¹ç›®å¼€å‘ç¬”è®°2"><img class="cover" src="/img/ArticleTopImgs/MSTTopImg.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-03-11</div><div class="info-item-2">é¢è¯•é€šé¡¹ç›®å¼€å‘ç¬”è®°2</div></div><div class="info-2"><div class="info-item-1">é¢è¯•é€šé¡¹ç›®å¼€å‘ç¬”è®°2ï¼ˆæš‚æ—¶åœæ›´ï¼‰</div></div></div></a><a class="pagination-related" href="/2025/02/27/MianShiTong/" title="é¢è¯•é€šé¡¹ç›®å¼€å‘ç¬”è®°"><img class="cover" src="/img/ArticleTopImgs/MSTTopImg.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-27</div><div class="info-item-2">é¢è¯•é€šé¡¹ç›®å¼€å‘ç¬”è®°</div></div><div class="info-2"><div class="info-item-1">é¢è¯•é€šé¡¹ç›®å¼€å‘ç¬”è®°</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/logo.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">XBXyftx</div><div class="author-info-description">åšå®‰åƒå¤æƒ…å¦‚æ­¤<br/>ç’‡ç‰å¦‚åè‡ªé†‰ä»</div><div class="site-data"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">30</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">34</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/XBXyftx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/XBXyftx" target="_blank" title="Github"><i class="fab fa-github" style="color: #c3ffff;"></i></a><a class="social-icon" href="mailto:shuaixbx02@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="/img/wechat.png" target="_blank" title="WeChat"><i class="fa-brands fa-weixin" style="color: #7bb342;"></i></a></div></div><div class="card-widget card-info visitor-info"><div class="card-content"><div class="visitor-welcome"><i class="fas fa-heart"></i><span id="visitor-text">æ¬¢è¿æ¥è®¿ï¼</span></div><div class="visitor-details"><div class="visitor-location"><i class="fas fa-map-marker-alt"></i><span id="visitor-location-text">æ­£åœ¨è·å–ä½ç½®ä¿¡æ¯...</span></div><div class="visitor-ip"><i class="fas fa-globe"></i><span>IPåœ°å€: </span><span id="visitor-ip-text">è·å–ä¸­...</span></div><div class="visitor-distance"><i class="fas fa-route"></i><span id="visitor-distance-text">è·ç¦»åšä¸» åŠ è½½ä¸­...</span></div><div class="visitor-tip"><i class="fas fa-moon"></i><span id="visitor-tip-text">æ™šä¸Šå¥½ï¼Œå¤œç”Ÿæ´»å—¨èµ·æ¥ï¼</span></div></div></div><script>// è®¿é—®è€…ä¿¡æ¯è·å–
(function() {
  // IPåœ°å€è·å–APIåˆ—è¡¨ï¼ˆæŒ‰ä¼˜å…ˆçº§æ’åºï¼‰
  const ipApis = [
    'https://api.ip.sb/geoip',
    'https://ipapi.co/json/',
    'https://freegeoip.app/json/',
    'https://ipinfo.io/json'
  ];
  
  let currentApiIndex = 0;
  
  function tryGetLocation() {
    if (currentApiIndex >= ipApis.length) {
      // æ‰€æœ‰APIéƒ½å¤±è´¥äº†ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
      handleError('æ‰€æœ‰IPæœåŠ¡éƒ½æ— æ³•è®¿é—®');
      return;
    }
    
    const currentApi = ipApis[currentApiIndex];
    
    fetch(currentApi)
      .then(response => {
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        return response.json();
      })
      .then(data => {
        processLocationData(data, currentApi);
      })
      .catch(error => {
        console.warn(`API ${currentApi} å¤±è´¥:`, error);
        currentApiIndex++;
        setTimeout(tryGetLocation, 1000); // 1ç§’åå°è¯•ä¸‹ä¸€ä¸ªAPI
      });
  }
  
  function processLocationData(data, apiUrl) {
    let country, region, city, ip, latitude, longitude;
    
    // æ ¹æ®ä¸åŒAPIæ ¼å¼å¤„ç†æ•°æ®
    if (apiUrl.includes('ip.sb')) {
      country = data.country || 'æœªçŸ¥';
      region = data.region || 'æœªçŸ¥';
      city = data.city || 'æœªçŸ¥';
      ip = data.ip || 'æœªçŸ¥';
      latitude = data.latitude;
      longitude = data.longitude;
    } else if (apiUrl.includes('ipapi.co')) {
      country = data.country_name || 'æœªçŸ¥';
      region = data.region || 'æœªçŸ¥';
      city = data.city || 'æœªçŸ¥';
      ip = data.ip || 'æœªçŸ¥';
      latitude = data.latitude;
      longitude = data.longitude;
    } else if (apiUrl.includes('freegeoip.app')) {
      country = data.country_name || 'æœªçŸ¥';
      region = data.region_name || 'æœªçŸ¥';
      city = data.city || 'æœªçŸ¥';
      ip = data.ip || 'æœªçŸ¥';
      latitude = data.latitude;
      longitude = data.longitude;
    } else if (apiUrl.includes('ipinfo.io')) {
      country = data.country || 'æœªçŸ¥';
      const loc = data.region || 'æœªçŸ¥';
      region = loc;
      city = data.city || 'æœªçŸ¥';
      ip = data.ip || 'æœªçŸ¥';
      if (data.loc) {
        const coords = data.loc.split(',');
        latitude = parseFloat(coords[0]);
        longitude = parseFloat(coords[1]);
      }
    }
    
    // æ›´æ–°IPåœ°å€
    document.getElementById('visitor-ip-text').textContent = ip;
    
    // æ›´æ–°ä½ç½®ä¿¡æ¯å’Œæ¬¢è¿æ–‡å­—
    let locationText = '';
    if (country === 'ä¸­å›½' || country === 'China' || country === 'CN') {
      locationText = `${region} ${city}`;
                    document.getElementById('visitor-text').innerHTML = `æ¬¢è¿æ¥è‡ª ${region} ${city} çš„æœ‹å‹â™¥ï¸`;
    } else {
      locationText = `${country} ${region}`;
      document.getElementById('visitor-text').innerHTML = `æ¬¢è¿æ¥è‡ª ${country} çš„æœ‹å‹â™¥ï¸`;
    }
    document.getElementById('visitor-location-text').textContent = locationText;
    
    // è®¡ç®—è·ç¦»ï¼ˆå¯é…ç½®åšä¸»ä½ç½®ï¼‰
    if (latitude && longitude && !isNaN(latitude) && !isNaN(longitude)) {
      const bloggerLat = 39.9042; // åŒ—äº¬çº¬åº¦
      const bloggerLng = 116.4074; // åŒ—äº¬ç»åº¦
      const distance = calculateDistance(latitude, longitude, bloggerLat, bloggerLng);
      
      if (distance < 1) {
        document.getElementById('visitor-distance-text').textContent = `è·ç¦»åšä¸» ${(distance * 1000).toFixed(0)} ç±³ï¼`;
      } else if (distance < 100) {
        document.getElementById('visitor-distance-text').textContent = `è·ç¦»åšä¸» ${distance.toFixed(1)} å…¬é‡Œï¼`;
      } else {
        document.getElementById('visitor-distance-text').textContent = `è·ç¦»åšä¸» ${distance.toFixed(0)} å…¬é‡Œï¼`;
      }
    } else {
      document.getElementById('visitor-distance-text').textContent = 'è·ç¦»è®¡ç®—ä¸­...';
    }
    
    // æ ¹æ®æ—¶é—´è®¾ç½®é—®å€™è¯­
    updateGreeting();
  }
  
  function updateGreeting() {
    const now = new Date();
    const hour = now.getHours();
    let greeting = '';
    let icon = 'fas fa-sun';
    
    if (hour >= 6 && hour < 12) {
      greeting = 'ä¸Šåˆå¥½ï¼Œæ–°çš„ä¸€å¤©å¼€å§‹äº†ï¼';
      icon = 'fas fa-sun';
    } else if (hour >= 12 && hour < 14) {
      greeting = 'ä¸­åˆå¥½ï¼Œè®°å¾—åƒåˆé¥­å“¦ï¼';
      icon = 'fas fa-sun';
    } else if (hour >= 14 && hour < 18) {
      greeting = 'ä¸‹åˆå¥½ï¼Œåˆåæ—¶å…‰çœŸç¾å¥½ï¼';
      icon = 'fas fa-cloud-sun';
    } else if (hour >= 18 && hour < 22) {
      greeting = 'æ™šä¸Šå¥½ï¼Œå¤œç”Ÿæ´»å—¨èµ·æ¥ï¼';
      icon = 'fas fa-moon';
    } else {
      greeting = 'æ·±å¤œäº†ï¼Œæ³¨æ„ä¼‘æ¯å“¦ï¼';
      icon = 'fas fa-moon';
    }
    
    const tipElement = document.getElementById('visitor-tip-text');
    const tipIcon = tipElement.parentElement.querySelector('i');
    tipElement.textContent = greeting;
    if (tipIcon) {
      tipIcon.className = icon;
    }
  }
  
  function handleError(message) {
    document.getElementById('visitor-ip-text').textContent = 'è·å–å¤±è´¥';
    document.getElementById('visitor-location-text').textContent = 'è·å–å¤±è´¥';
    document.getElementById('visitor-distance-text').textContent = 'è·ç¦»æœªçŸ¥';
    document.getElementById('visitor-text').innerHTML = 'æ¬¢è¿æ¥è®¿ï¼';
    console.error('è·å–è®¿é—®è€…ä¿¡æ¯å¤±è´¥:', message);
  }
  
  // è®¡ç®—ä¸¤ç‚¹é—´è·ç¦»çš„å‡½æ•°ï¼ˆä½¿ç”¨Haversineå…¬å¼ï¼‰
  function calculateDistance(lat1, lon1, lat2, lon2) {
    const R = 6371; // åœ°çƒåŠå¾„ï¼Œå•ä½ï¼šåƒç±³
    const dLat = deg2rad(lat2 - lat1);
    const dLon = deg2rad(lon2 - lon1);
    const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
              Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
              Math.sin(dLon/2) * Math.sin(dLon/2);
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    return R * c;
  }
  
  function deg2rad(deg) {
    return deg * (Math.PI/180);
  }
  
  // å¯åŠ¨è·å–ä½ç½®ä¿¡æ¯
  tryGetLocation();
  
  // æ¯åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡é—®å€™è¯­
  setInterval(updateGreeting, 60000);
})(); </script></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">æœ€è¿‘ä¹Ÿæ˜¯ç»™è‡ªå·±æŒ–äº†æŒºå¤šå‘è¿˜æ²¡å¡«ä¸Šçš„ç­‰æš‘å‡æ…¢æ…¢å¡«å§ï¼Œäº‰å–æš‘å‡æŠŠè‡ªå·±æƒ³å†™çš„éƒ½å†™ä¸Šã€‚<br/><img src="https://bu.dusays.com/2025/06/03/683ec52fd0dbc.jpg" alt="1748944170064.jpg" title="1748944170064.jpg" class="announcementImg"/></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#State%E5%92%8C-Loacl%E3%80%81-Param-Once"><span class="toc-number">2.</span> <span class="toc-text">@Stateå’Œ@Loaclã€@Param@Once</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#State%E7%9A%84%E7%BC%BA%E9%99%B7%E4%B8%8EV2%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">2.1.</span> <span class="toc-text">@Stateçš„ç¼ºé™·ä¸V2çš„è§£å†³æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Param%E5%92%8C-Once"><span class="toc-number">2.2.</span> <span class="toc-text">@Paramå’Œ@Once</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Param"><span class="toc-number">2.2.1.</span> <span class="toc-text">@Param</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Once"><span class="toc-number">2.2.2.</span> <span class="toc-text">@Once</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Link%E5%92%8C-Event%E3%80%81-Param"><span class="toc-number">3.</span> <span class="toc-text">@Linkå’Œ@Eventã€@Param</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E5%90%91%E7%BB%91%E5%AE%9A%E8%AF%AD%E6%B3%95%E7%B3%96"><span class="toc-number">3.1.</span> <span class="toc-text">åŒå‘ç»‘å®šè¯­æ³•ç³–!!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Watch%E5%92%8C-Monitor"><span class="toc-number">4.</span> <span class="toc-text">@Watchå’Œ@Monitor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AppStorageV2%E5%92%8CPersistenceV2"><span class="toc-number">5.</span> <span class="toc-text">AppStorageV2å’ŒPersistenceV2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">6.</span> <span class="toc-text">è¡¥å……</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/06/29/OpenSourceSummer2025/" title="å¼€æºä¹‹å¤NowInOpenHarmony"><img src="/img/ArticleTopImgs/OpenSourceSummerTopImg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="å¼€æºä¹‹å¤NowInOpenHarmony"/></a><div class="content"><a class="title" href="/2025/06/29/OpenSourceSummer2025/" title="å¼€æºä¹‹å¤NowInOpenHarmony">å¼€æºä¹‹å¤NowInOpenHarmony</a><time datetime="2025-06-29T06:01:21.000Z" title="å‘è¡¨äº 2025-06-29 14:01:21">2025-06-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/27/BlogSetup/" title="åˆ›å®¢ç©ºé—´2025çº§æ–°ç”Ÿè®­ç»ƒè¥åšå®¢æ­å»ºèµ›é“"><img src="/img/ArticleTopImgs/BlogSetupTopImg.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="åˆ›å®¢ç©ºé—´2025çº§æ–°ç”Ÿè®­ç»ƒè¥åšå®¢æ­å»ºèµ›é“"/></a><div class="content"><a class="title" href="/2025/06/27/BlogSetup/" title="åˆ›å®¢ç©ºé—´2025çº§æ–°ç”Ÿè®­ç»ƒè¥åšå®¢æ­å»ºèµ›é“">åˆ›å®¢ç©ºé—´2025çº§æ–°ç”Ÿè®­ç»ƒè¥åšå®¢æ­å»ºèµ›é“</a><time datetime="2025-06-27T08:45:41.000Z" title="å‘è¡¨äº 2025-06-27 16:45:41">2025-06-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/24/typewriter/" title="Butterflyä¸»é¢˜å®ç°ç®€ä»‹æ‰“å­—æœº"><img src="/img/ArticleTopImgs/TypeWriteTopImg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Butterflyä¸»é¢˜å®ç°ç®€ä»‹æ‰“å­—æœº"/></a><div class="content"><a class="title" href="/2025/06/24/typewriter/" title="Butterflyä¸»é¢˜å®ç°ç®€ä»‹æ‰“å­—æœº">Butterflyä¸»é¢˜å®ç°ç®€ä»‹æ‰“å­—æœº</a><time datetime="2025-06-24T05:18:53.000Z" title="å‘è¡¨äº 2025-06-24 13:18:53">2025-06-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/03/CloudWorkflow/" title="ä¸é™ç»ˆç«¯çš„äº‘å·¥ä½œæµæ­å»ºå†ç¨‹"><img src="/img/ArticleTopImgs/cloudWorkflawTopImg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ä¸é™ç»ˆç«¯çš„äº‘å·¥ä½œæµæ­å»ºå†ç¨‹"/></a><div class="content"><a class="title" href="/2025/06/03/CloudWorkflow/" title="ä¸é™ç»ˆç«¯çš„äº‘å·¥ä½œæµæ­å»ºå†ç¨‹">ä¸é™ç»ˆç«¯çš„äº‘å·¥ä½œæµæ­å»ºå†ç¨‹</a><time datetime="2025-06-03T09:35:35.000Z" title="å‘è¡¨äº 2025-06-03 17:35:35">2025-06-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/23/HarmonyOSPersistent/" title="é¸¿è’™å¼€å‘æ•°æ®æŒä¹…åŒ–ç®€è¿°"><img src="/img/ArticleTopImgs/persistentTopImg.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="é¸¿è’™å¼€å‘æ•°æ®æŒä¹…åŒ–ç®€è¿°"/></a><div class="content"><a class="title" href="/2025/05/23/HarmonyOSPersistent/" title="é¸¿è’™å¼€å‘æ•°æ®æŒä¹…åŒ–ç®€è¿°">é¸¿è’™å¼€å‘æ•°æ®æŒä¹…åŒ–ç®€è¿°</a><time datetime="2025-05-23T12:46:19.000Z" title="å‘è¡¨äº 2025-05-23 20:46:19">2025-05-23</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/footerBg.png);"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By XBXyftx</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><a target="_blank" rel="noopener" href="https://beian.miit.gov.cn/#/Integrated/index"><span>å¤‡æ¡ˆå·ï¼šäº¬ICPå¤‡2025126467å·</span></a></div><div></div><span id="timeDate">è½½å…¥å¤©æ•°...</span><span id="times">è½½å…¥æ—¶åˆ†ç§’...</span><script>var now = new Date(); 
function createtime() { 
var grt = new Date("4/25/2024 18:30"); // åœ¨æ­¤å¤„ä¿®æ”¹ä½ çš„å»ºç«™æ—¶é—´
now.setTime(now.getTime() + 250); 
days = (now - grt) / 1000 / 60 / 60 / 24; 
dnum = Math.floor(days); 
hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum); 
hnum = Math.floor(hours); 
if (String(hnum).length == 1) { hnum = "0" + hnum; } 
minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum); 
mnum = Math.floor(minutes); 
if (String(mnum).length == 1) { mnum = "0" + mnum; } 
seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
snum = Math.round(seconds); 
if (String(snum).length == 1) { snum = "0" + snum; } 
document.getElementById("timeDate").innerHTML = "æœ¬ç½‘ç«™å·²è¿è¡Œ " + dnum + " å¤© "; 
document.getElementById("times").innerHTML = hnum + " å°æ—¶ " + mnum + " åˆ† " + snum + " ç§’"; 
} 
setInterval(createtime, 250);</script></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="å‰å¾€è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa-solid fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa-solid fa-arrow-rotate-right"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa-solid fa-arrow-right"></i></a><a class="rightMenu-item" id="menu-radompage" href="javascript:window.location.href = window.location.origin;"><i class="fa-solid fa-house"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa-solid fa-copy"></i><span>å¤åˆ¶</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:rmf.switchReadMode();"><i class="fa-solid fa-book"></i><span>é˜…è¯»æ¨¡å¼</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/node-snackbar/0.1.16/snackbar.min.js"></script><!-- ç€‘å¸ƒæµJavaScript - åªåœ¨é¦–é¡µåŠ è½½--><!-- æ–‡ç« æ‰“å­—æœºæ•ˆæœ - åªåœ¨æ–‡ç« é¡µé¢åŠ è½½--><script src="/js/typewriter-effect.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikooxbx.netlify.app/.netlify/functions/twikoo',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikooxbx.netlify.app/.netlify/functions/twikoo',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('/js/twikoo.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script>localStorage.setItem('theme','dark')</script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script> // å¼ºåˆ¶é”å®šä¸ºæš—é»‘æ¨¡å¼ localStorage.setItem('theme', 'dark'); // é˜²æ­¢å…¶ä»–è„šæœ¬è¦†ç›–æ¨¡å¼ document.documentElement.setAttribute('data-theme', 'dark'); </script><link rel="stylesheet" href="/css/styles.css"><script> document.querySelectorAll('#post-comment).forEach(el => { el.style.backgroundColor = 'rgba(255, 255, 255, 0.6)'; }); </script><script src="/js/jquery-3.6.0.min.js"></script><script src="/js/rightmenu.js"></script><link rel="twikoo" href="/css/twikoo.css"><script src="/js/happy-title.js" async></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="/%5Bobject%20Object%5D"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="99" count="99" mobile="true" src="/%5Bobject%20Object%5D"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementsByClassName('recent-posts')[0];
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/06/24/typewriter/" alt=""><img width="48" height="48" src="/img/ArticleTopImgs/TypeWriteTopImg.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-06-24</span><a class="blog-slider__title" href="2025/06/24/typewriter/" alt="">Butterflyä¸»é¢˜å®ç°ç®€ä»‹æ‰“å­—æœº</a><div class="blog-slider__text">è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨Hexoçš„Butterflyä¸»é¢˜ä¸­æ·»åŠ ç‚«é…·çš„æ‰“å­—æœºæ•ˆæœï¼ŒåŒ…å«å®Œæ•´çš„å®ç°ä»£ç å’Œé…ç½®æ–¹æ³•ã€‚</div><a class="blog-slider__button" href="2025/06/24/typewriter/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/04/30/ToTheApril2025/" alt=""><img width="48" height="48" src="/img/ArticleTopImgs/AprilTopImg.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-04-30</span><a class="blog-slider__title" href="2025/04/30/ToTheApril2025/" alt="">è‡´2025é‚£ä¸ªç¹å¿™çš„4æœˆ</a><div class="blog-slider__text">äººä»¬æ€»æ˜¯åŒ†åŒ†å‘å‰ï¼Œæ®Šä¸çŸ¥æ—¶å…‰æ˜“é€å•Šâ€¦â€¦ï¼ˆæŒç»­æ›´æ–°ä¸­ï¼ï¼ï¼ï¼‰</div><a class="blog-slider__button" href="2025/04/30/ToTheApril2025/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/03/16/yiDuo/" alt=""><img width="48" height="48" src="/img/ArticleTopImgs/yiduoTopImg.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-03-16</span><a class="blog-slider__title" href="2025/03/16/yiDuo/" alt="">å…³äºé¸¿è’™çš„ä¸€å¤šèƒ½åŠ›</a><div class="blog-slider__text">ä¸€å¤šèƒ½åŠ›çš„å­¦ä¹ ç¬”è®°</div><a class="blog-slider__button" href="2025/03/16/yiDuo/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/02/04/V2/" alt=""><img width="48" height="48" src="/img/ArticleTopImgs/V2TopImg.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-02-04</span><a class="blog-slider__title" href="2025/02/04/V2/" alt="">æµ…è°ˆé¸¿è’™çŠ¶æ€ç®¡ç†V1â€”â€”&gt;V2</a><div class="blog-slider__text">ç”¨å®é™…ä»£ç æµ‹è¯•ä¸æˆ‘çš„å¼€å‘ç»éªŒï¼Œè§£æé¸¿è’™çŠ¶æ€ç®¡ç†V2ä¸­éš¾ä»¥ç†è§£çš„å†…å®¹ï¼Œå¸®åŠ©å¼€å‘è€…ä»¬æ›´å¥½çš„ç†è§£å’Œä½¿ç”¨çŠ¶æ€ç®¡ç†V2ç‰ˆæœ¬ã€‚</div><a class="blog-slider__button" href="2025/02/04/V2/" alt="">è¯¦æƒ…   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2025/04/20/RemoteCommunication/" alt=""><img width="48" height="48" src="/img/ArticleTopImgs/RCPTopImg.png" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-04-20</span><a class="blog-slider__title" href="2025/04/20/RemoteCommunication/" alt="">è¿œåœºé€šä¿¡æœåŠ¡</a><div class="blog-slider__text">æœ¬æ–‡å°†ä»‹ç»é¸¿è’™è¿œåœºé€šä¿¡æœåŠ¡</div><a class="blog-slider__button" href="2025/04/20/RemoteCommunication/" alt="">è¯¦æƒ…   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('å·²æŒ‚è½½butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --></body></html>